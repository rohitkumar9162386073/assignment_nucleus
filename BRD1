package org.example;

import java.io.*;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.util.ArrayList;

public class CustomerDataProcessor {
    // File path of the input CSV file
    private static final String CSV_FILE_PATH = "C:\\Users\\Rohitkumar.Singh\\Downloads\\JAVA_ASSIGNMENT\\Test_Input_1.txt";

    public static void main(String[] args) throws SQLException, IOException {
        ConnectionCreation cn=new ConnectionCreation();
        System.out.println();
        ArrayList<String> list = new ArrayList<String>();
        try {
            BufferedReader reader = new BufferedReader(new FileReader(CSV_FILE_PATH));
            String line = null;
            int index = 1;
            while ((line = reader.readLine()) != null) {
                String[] fields = line.split("~", line.length());
                for (int i = 0; i < fields.length; i++) {
                    list.add(fields[i]);
                    // System.out.print(st[i]+ " ; ");
                }
                boolean bool=Validate.Validation1(list);
               // if(bool==true) {
                    cn.jdbcConnection(list, index);
                    index++;
               // }
              //  else{
                  //  System.out.println("There is an discrepencies in the data");
                  //  break;}
//                System.out.print(list);
//                System.out.println(list.size());
                list.clear();
            }
        } catch (Exception ex) {
            ex.getMessage();
        }
        finally {
            System.out.println("done with the execution");
        }
    }
}




package org.example;
import java.sql.*;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
public class ConnectionCreation {

    void jdbcConnection(java.util.ArrayList<String> list, int i) throws ParseException, ClassNotFoundException {
        String url = "oracle.jdbc.driver.OracleDriver";
        String user = "sh";
        String password = "sh";
        String sql = "INSERT INTO Customer_Master_Table_Rohit (CUSTOMER_ID,CUSTOMER_CODE, CUSTOMER_NAME, CUSTOMER_ADDRESS_1, CUSTOMER_ADDRESS_2, CUSTOMER_PIN_CODE,EMAIL_ADDRESS,CONTACT,PRIMARY_CONTACT_PERSON,RECORD_STATUS,ACTIVE_INACTIVE_FLAG,CREATE_DATE,CREATED_BY,MODIFIED_DATE,MODIFIED_BY,AUTHORIZED_DATE,AUTHORIZED_BY) VALUES (?,?, ?, ?, ?, ?,?, ?, ?, ?, ?,?, ?, ?, ?, ?,?)";
        ArrayList<String> list1 = list;
        System.out.println(list1 + "Connection");
        try  {
            Class.forName(url);
            System.out.println("Exit");
            Connection conn = DriverManager.getConnection(url, user, password);
            PreparedStatement stmt = conn.prepareStatement(sql);
            stmt.setInt(1, i+1);
                stmt.setString(2, list1.get(0));
                stmt.setString(3, list1.get(1));
                stmt.setString(4, list1.get(2));
                stmt.setString(5, list1.get(3));
                stmt.setString(6, list1.get(4));
                stmt.setString(7, list1.get(5));//Integer.parseInt(list1.get(3)));
                stmt.setInt(8, Integer.parseInt(list1.get(6)));
                stmt.setString(9, list1.get(7));
                stmt.setInt(10, Integer.parseInt(list1.get(8)));
                stmt.setString(11, list1.get(8));
                stmt.setString(12, list1.get(10));
                stmt.setDate(13, (Date) new SimpleDateFormat().parse(list1.get(11)));
                stmt.setString(14, list1.get(10));
                stmt.setDate(15, (Date) new SimpleDateFormat().parse(list1.get(11)));
                stmt.setString(16, list1.get(13));
                stmt.setDate(17, (Date) new SimpleDateFormat().parse(list1.get(15)));
                int j = stmt.executeUpdate();
                stmt.executeUpdate("commit");
                System.out.println(++j + " records inserted");
                System.out.println();

            int[] updateCounts = stmt.executeBatch();
            System.out.println("Rows inserted: " + updateCounts.length);
            conn.close();
        } catch (Exception e) {
            System.out.println("SQL Exception: " + e.getMessage());
        }
    }
}

