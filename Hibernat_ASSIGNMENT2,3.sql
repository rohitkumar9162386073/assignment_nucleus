CL SCR;

--QUESTION 1--
CREATE TABLE LMS_CUSTOMER_M_SAGAR8998(
    Customer_ID VARCHAR(20)  NOT NULL,
    First_Name VARCHAR(20) NOT NULL,
    Last_Name VARCHAR(20),
    Gender VARCHAR(1) NOT NULL,
    Date_Of_Birth DATE NOT NULL,
    Contact_Number VARCHAR(10) NOT NULL,
    Email_Address VARCHAR(40) NOT NULL,
    Monthly_Income NUMBER(8,2) NOT NULL,
    Profession VARCHAR(40),
    Total_Monthly_Expense NUMBER(8,2) NOT NULL,
    Designation VARCHAR(40),
    Company_Name VARCHAR(40)
);




--QUESTION 2--
CREATE TABLE LMS_PRODUCT_CATEGORY_M_SAGAR8998(
    Category_ID VARCHAR(10) NOT NULL,
    Category_Name VARCHAR(50) NOT NULL,
    Asset_Based VARCHAR(1) NOT NULL CHECK (Asset_Based IN ('Y', 'N')),
    Description  VARCHAR(150),
    SecuredLoan VARCHAR(2) NOT NULL CHECK (SecuredLoan IN ('S', 'US'))
);


--QUESTION 3--
CREATE TABLE LMS_Product_M_SAGAR8998(
    Product_Code VARCHAR(20) NOT NULL,
    Product_Name VARCHAR(100) NOT NULL,
    Product_Description VARCHAR(200),
    Product_Category VARCHAR(10) NOT NULL,
    Max_Tenure NUMBER(2),
    Min_Tenure NUMBER(2)
);



--QUESTION 4--
CREATE TABLE LMS_AGREEMENT_DTL_SAGAR8998(
    Agreement_ID VARCHAR(20) NOT NULL,
    Lessee_ID VARCHAR(100) NOT NULL,
    Tenure NUMBER(2),
    ROI NUMBER(3,1),
    Loan_Amount NUMBER(10,2),
    Repayment_Frequency VARCHAR(2) CHECK(Repayment_Frequency IN('M', 'Y', 'Q', 'HY')),     /*M – Monthly, Y – Yearly, Q – Quarterly, HY – Half Yearly  */
    Loan_Disbursal_Date DATE,
    Status VARCHAR(10) CHECK(Status IN('Pending', 'Approved', 'Rejected', 'Active', 'Closed')),
    Product_Code VARCHAR(20) NOT NULL
);



--QUESTION 5--
CREATE TABLE LMS_REPAYSCH_DTL_SAGAR8998 (
    Agreement_id VARCHAR(20) NOT NULL,
    PropInstID NUMBER(8),
    Installment_Amount NUMBER(18,5) NOT NULL,
    Installment_Number NUMBER(3) NOT NULL, 
    Principal_Component NUMBER(18,5) NOT NULL,
    Interest_Component NUMBER(18,5) NOT NULL,
    Balance_Principal_Amount NUMBER(8,5) NOT NULL,
    Penalty_Charges NUMBER(18,5),
    Installment_Due_Date DATE NOT NULL 
);



--QUESTION 6--
CREATE TABLE LMS_TXNTYPE_M_SAGAR8998 (
    Txn_Type VARCHAR(20) NOT NULL CHECK(Txn_Type IN('Installment', 'LPP')),
    Description VARCHAR(100)
);



--QUESTION 7--

CREATE TABLE LMS_TXN_ADVICE_DTL_SAGAR8998 (
    Txn_Advice_ID NUMBER(8),
    Adviceamt NUMBER(12,2) NOT NULL,
    AdviceDate DATE NOT NULL,
    Case_Id VARCHAR(20) NOT NULL,
    TxnID varchar(10) NOT NULL,
    TxnType VARCHAR(20) NOT NULL
);



--QUESTION 8--
CREATE TABLE LMS_CHEQUE_DTL_SAGAR898 (
    Cheque_Id NUMBER(8),
    Payment_Mode VARCHAR(1) CHECK(Payment_Mode IN('C', 'Q', 'D', 'T')),
    /* Mode of payment of instrument. Applicable values are C - Cash 
    Q - Cheque 
    D - Draft 
    T - Fund Transfer 
    */
    Cheque_Num VARCHAR(50) CHECK(Cheque_Num IN(
        CASE Cheque_Num
            WHEN 'Q' THEN Cheque_Num
            --WHEN 'T' THEN Transfer_Account_Number
            END
        )),
    Cheque_Date DATE,
    Cheque_Amount NUMBER(10,2),
    Drawn_On_Bank VARCHAR(50),
    Deposit_Date DATE,
    Status VARCHAR(1) CHECK(Status IN('C', 'D', 'X', 'B'))
    /*
    Status of the cheque 
    C	- Realized 
    D	- Deposit 
    X - cancelled 
    B - bounced 
    */

);

--QUESTION 9--
CREATE TABLE LMS_PAYMENT_DTL_SAGAR8998 (
    Payment_ID NUMBER(8) NOT NULL UNIQUE,
    Cheque_ID NUMBER(8) NOT NULL UNIQUE,
    Payment_Date DATE NOT NULL,
    Status VARCHAR(1) CHECK(Status IN('C', 'N')),
    Txn_Advice_Id NUMBER(8) NOT NULL
);



--QUESTION 10--
SELECT table_name FROM all_tables;


--CLEARING SCREEN--
CL SCR


--QUESTION 11--

ALTER TABLE LMS_CUSTOMER_M_SAGAR8998
    ADD CONSTRAINT LMS_CUSTOMER_M_SAGAR8998_PK PRIMARY KEY(Customer_ID );
    
ALTER TABLE lMS_PRODUCT_CATEGORY_M_SAGAR8998
    ADD CONSTRAINT MS_PRODUCT_CATEGORY_M_SAGAR8998_PK PRIMARY KEY(Category_ID );
    
ALTER TABLE LMS_Product_M_SAGAR8998
    ADD CONSTRAINT LMS_Product_M_SAGAR8998_PK PRIMARY KEY(Product_Code);

ALTER TABLE LMS_AGREEMENT_DTL_SAGAR8998
    ADD CONSTRAINT LMS_AGREEMENT_DTL_SAGAR8998_PK PRIMARY KEY(Agreement_ID );

ALTER TABLE LMS_REPAYSCH_DTL_SAGAR8998
    ADD CONSTRAINT LMS_REPAYSCH_DTL_SAGAR8998_PK PRIMARY KEY(PropInstID);

ALTER TABLE LMS_TXNTYPE_M_SAGAR8998
    ADD CONSTRAINT LMS_TXNTYPE_M_SAGAR8998_PK PRIMARY KEY(Txn_Type);

ALTER TABLE LMS_TXN_ADVICE_DTL_SAGAR8998
    ADD CONSTRAINT LMS_TXN_ADVICE_DTL_SAGAR8998_PK PRIMARY KEY(Txn_Advice_ID );

ALTER TABLE LMS_CHEQUE_DTL_SAGAR8998
    ADD CONSTRAINT LMS_CHEQUE_DTL_SAGAR8998 PRIMARY KEY(Cheque_ID);


-- searching the constraint name in LMS_PAYMENT_DTL_SAGAR899 to make the column non unique--
select CONSTRAINT_NAME, CONSTRAINT_TYPE, TABLE_NAME
from USER_CONSTRAINTS
where TABLE_NAME='LMS_PAYMENT_DTL_SAGAR8998';
----------------------------------------------------------------------------------------
    
ALTER TABLE LMS_PAYMENT_DTL_SAGAR8998
    DROP CONSTRAINT SYS_C00121339;

ALTER TABLE LMS_PAYMENT_DTL_SAGAR8998
    ADD CONSTRAINT LMS_PAYMENT_DTL_SAGAR8998_PK PRIMARY KEY(Payment_ID);


--QUESTION 12
/*
ALTER TABLE LMS_Product_M_SAGAR899
    ADD CONSTRAINT LMS_Product_CAT_FK_SAGAR899
    FOREIGN KEY(Product_Category ) REFERENCES LMS_Product_Category_M(Category_ID);
    
ALTER TABLE LMS_Agreement_DTL_SAGAR899
    ADD CONSTRAINT LMS_Agreement_Dtl_FK1_SAGAR899
    FOREIGN KEY(Lessee_ID) REFERENCES LMS_Customer_M(Customer_ID);

ALTER TABLE LMS_Agreement_DTL_SAGAR899
    ADD CONSTRAINT LMS_Agreement_Dtl_FK2_SAGAR899
    FOREIGN KEY(Product_code) REFERENCES LMS_Product_M(Product_code);

ALTER TABLE LMS_REPAYSCH_DTL_SAGAR899
    ADD CONSTRAINT LMS_Repaysch_Dtl_FK_SAGAR899
    FOREIGN KEY(Agreement_Id) REFERENCES LMS_Agreementt_DTL(Agreement_id); */
    
-- DROPPING UPPER CONSTRAINTS--

/*
ALTER TABLE LMS_REPAYSCH_DTL_SAGAR899
    DROP CONSTRAINT LMS_Repaysch_Dtl_FK_SAGAR899;*/
    
ALTER TABLE LMS_Product_M_SAGAR8998
    ADD CONSTRAINT LMS_Product_CAT_SAGAR8998_FK
    FOREIGN KEY(Product_Category ) REFERENCES LMS_Product_Category_M_SAGAR8998(Category_ID);
    
ALTER TABLE LMS_Agreement_DTL_SAGAR8998
    ADD CONSTRAINT LMS_Agreement_DTL_SAGAR8998_FK1
    FOREIGN KEY(Lessee_ID) REFERENCES LMS_Customer_M_SAGAR8998(Customer_ID);
    
ALTER TABLE LMS_Agreement_DTL_SAGAR8998
    ADD CONSTRAINT LMS_Agreement_DTL_SAGAR8998_FK2
    FOREIGN KEY(Product_code) REFERENCES LMS_Product_M_SAGAR8998(Product_code);

ALTER TABLE LMS_REPAYSCH_DTL_SAGAR8998
    ADD CONSTRAINT LMS_REPAYSCH_DTL_SAGAR8998_FK
    FOREIGN KEY(Agreement_Id) REFERENCES LMS_AGREEMENT_DTL_SAGAR8998(Agreement_id);

ALTER TABLE LMS_TXN_ADVICE_DTL_SAGAR8998
    ADD CONSTRAINT LMS_TXN_ADVICE_DTL_SAGAR8998_FK1
    FOREIGN KEY(TxnType) REFERENCES LMS_TXNTYPE_M_SAGAR8998(Txn_Type);
    
ALTER TABLE LMS_TXN_ADVICE_DTL_SAGAR8998
    ADD CONSTRAINT LMS_TXN_ADVICE_DTL_SAGAR8998_FK2
    FOREIGN KEY(Case_Id) REFERENCES LMS_Agreement_DTL_SAGAR8998(Agreement_id);

ALTER TABLE LMS_TXN_ADVICE_DTL_SAGAR8998
    ADD CONSTRAINT LMS_TXN_ADVICE_DTL_SAGAR8998_FK3
    FOREIGN KEY(Txn_Advice_ID) REFERENCES LMS_REPAYSCH_DTL_SAGAR8998(PropInstID);

ALTER TABLE LMS_Payment_DTL_SAGAR8998
    ADD CONSTRAINT LMS_Payment_DTL_SAGAR8998_FK1
    FOREIGN KEY(Cheque_ID) REFERENCES LMS_CHEQUE_DTL_SAGAR8998(Cheque_id);

ALTER TABLE LMS_Payment_DTL_SAGAR8998
    ADD CONSTRAINT LMS_Payment_DTL_SAGAR8998_FK2
    FOREIGN KEY(Txn_Advice_Id) REFERENCES LMS_TXN_ADVICE_DTL_SAGAR8998(Txn_Advice_id);


--QUESTION 13--
ALTER TABLE LMS_CUSTOMER_M_SAGAR8998
MODIFY (
    Last_Name VARCHAR(30)
);
-- TO CHECK--
DESC LMS_CUSTOMER_M_SAGAR8998;

--QUESTION 14--
CREATE TABLE CUSTOMER2_SAGAR8998(
    ID VARCHAR(20) NOT NULL,
    NAME VARCHAR(20) NOT NULL,
    EMAIL VARCHAR(40) NOT NULL,
    PROFESSION VARCHAR(40),
    INCOME NUMBER(8,2)
);

--QUESTION 15--
DROP TABLE CUSTOMER2_SAGAR8998;

--QUESTION 16--
SHOW RECYCLEBIN;

--QUESTION 17--
FLASHBACK TABLE CUSTOMER2_SAGAR8998 TO BEFORE DROP;

--QUESTION 18--
SHOW RECYCLEBIN;

--QUESTION 19--
ALTER TABLE CUSTOMER2_SAGAR8998
    DROP COLUMN NAME;
    
    
-----------------------------------------------------DML (DATA MANIPULATION LANGUAGE)--------------------------------

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 VALUES(
    'C01', 'NAME_1', 'LAST_NAME_2', 'M', TO_DATE('19-JAN-2001', 'DD-MON-YYYY'),
    1234567890, 'firstlast1@gmai.com', 15000, 'business', 5000, 'CEO', 'abcxyz'
);

--QUESTION 2--
INSERT INTO LMS_CUSTOMER_M_SAGAR8998(
    Customer_ID, First_Name, Last_Name, Gender, Date_Of_Birth, Contact_Number, 
    Email_Address, Monthly_Income, Profession, Total_Monthly_Expense, Designation, 
    Company_Name
)VALUES (
    'C02', 'NAME_2', 'LAST_NAME_2', 'M', TO_DATE('24-NOV-2001', 'DD-MM-YYYY'),
    0987654321, 'firstlast2@gmail.com', 20000, 'job', 10000, 'software engineer', 'jupyter'
);


--Question 3--
SELECT * FROM LMS_CUSTOMER_M_SAGAR8998;

--QUESTION 4--
INSERT INTO LMS_CUSTOMER_M_SAGAR8998 values (
    '&Customer_ID', '&First_Name', '&Last_Name', '&Gender', '&Date_Of_Birth', '&Contact_Number', 
    '&Email_Address', '&Monthly_Income', '&Profession', '&Total_Monthly_Expense', '&Designation', 
    '&Company_Name'
);

SELECT * FROM LMS_CUSTOMER_M_SAGAR8998;

DELETE FROM LMS_CUSTOMER_M_SAGAR8998;

--QUESTION


INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C101', 'Amit', 'Gupta', 'M', to_date('10-Jan-88', 'DD-MON-RR'), 9876545678, 'amit.gupta@gmail.com', 50000, 'Service', 15000, 'Software Engineer', 'Nucleus');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C102', 'Rekha', 'Arora', 'F', to_date('8-Aug-76', 'DD-MON-RR'), 9878974561, 'arekha@gmail.com', 100000, 'Service', 40000, 'Project Manager', 'TCS');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C103', 'Arun', 'Shabarwal', 'M', to_date('9-Sep-78', 'DD-MON-RR'), 8989234123, 'arun.s@gmail.com', 80000, 'Self-Employed', 40000, 'Play School Owner', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C104', 'Mayank', 'Mittal', 'M', to_date('20-Jan-87', 'DD-MON-RR'), 8978654563, 'mayank.mittal@gmail.com', 120000, 'Self-Employed', 60000, 'Fitness Trainer', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C105', 'Kiran', 'Jain', 'F', to_date('15-Aug-79', 'DD-MON-RR'), 8097652345, 'kiran.jain@gmail.com', 200000, 'Self-Employed', 80000, 'Chartered Accountant', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C106', 'Sapna', 'Ranjan', 'F', to_date('12-Jun-80', 'DD-MON-RR'), 9997865432, 'sapna.ranjan@gmail.com', 80000, 'Service', 30000, 'HR Manager', 'Wipro');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C107', 'Geetika', 'Kumari', 'F', to_date('2-Apr-89', 'DD-MON-RR'), 9011234568, 'geetika.kumari@gmail.com', 60000, 'Service', 25000, 'Sr. Software Engineer', 'IBM');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C108', 'Puneet', 'Sharma', 'M', to_date('19-Dec-70', 'DD-MON-RR'), 8878654321, 'puneet.sharma@gmail.com', 75000, 'Service', 30000, 'DBA', 'TerraData');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C109', 'Pooja', 'Agarwal', 'F', to_date('5-Oct-71', 'DD-MON-RR'), 7756789543, 'pooja.agarwal@gmail.com', 100000, 'Service', 35000, 'Technial Lead', 'IBM');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C110', 'Sapan', 'Gupta', 'M', to_date('10-Apr-88', 'DD-MON-RR'), 7987654422, 'sapan.gupta@gmail.com', 90000, 'Self-Employed', 40000, 'Interior Designer', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C111', 'Abhay', 'Singh', 'M', to_date('17-May-82', 'DD-MON-RR'), 8932457654, 'abhay.singh@gmail.com', 45000, 'Self-Employed', 15000, 'Graphic Designer', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C112', 'Pulkit', 'Ahuja', 'M', to_date('11-Apr-72', 'DD-MON-RR'), 9911456743, 'pulkit.ahuja@gmail.com', 60000, 'Self-Employed', 20000, 'Content Writer', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C113', 'Manju', 'Sharma', 'F', to_date('13-Sep-72', 'DD-MON-RR'), 9999678954, 'manju.sharma@gmail.com', 125000, 'Service', 38000, 'Solution Consultant', 'Nucleus');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C114', 'Snehal', 'Tiwari', 'F', to_date('26-Jan-74', 'DD-MON-RR'), 8769787654, 'snehal.tiwari@gmail.com', 100000, 'Service', 60000, 'Project Manager', 'Wipro');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C115', 'Abhishek', 'Kumar', 'M', to_date('2-Oct-69', 'DD-MON-RR'), 8134567890, 'abhishek.kumar@gmail.com', 230000, 'Self-Employed', 80000, 'Event Planner', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C116', 'Raj', 'Arora', 'M', to_date('10-Sep-90', 'DD-MON-RR'), 7895432123, 'raj.arora@gmail.com', 65000, 'Service', 25000, 'Sr. Software Engineer', 'HCL');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C117', 'Pallavi', 'Joshi', 'F', to_date('12-Jun-89', 'DD-MON-RR'), 8765908921, 'pallavi.joshi@gmail.com', 40000, 'Service', 30000, 'Software Engineer', 'Infogain');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C118', 'Surjit', 'Kaur', 'F', to_date('11-Mar-74', 'DD-MON-RR'), 8967885431, 'surjit.kaur@gmail.com', 125000, 'Service', 45000, 'Solution Consultant', 'HCL');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C119', 'Karan', 'Singh', 'M', to_date('10-May-73', 'DD-MON-RR'), 8888675432, 'karan.singh@gmail.com', 70000, 'Self-Employed', 28000, 'Fitness Trainer', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C120', 'Raman', 'Jaiswal', 'M', to_date('7-Jan-88', 'DD-MON-RR'), 9780006643, 'raman.jaiswal@gmail.com', 200000, 'Self-Employed', 70000, 'Event Planner', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C121', 'Atif', 'Rana', 'M', to_date('18-Apr-87', 'DD-MON-RR'), 9124678901, 'atif.rana@gmail.com', 45000, 'Self-Employed', 30000, 'Digital Marketing', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C122', 'Deepak', 'Kumar', 'M', to_date('15-Jun-76', 'DD-MON-RR'), 7089654321, 'deepak.kumar@gmail.com', 45000, 'Self-Employed', 20000, 'Digital Marketing', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C123', 'Sneha', 'Raj', 'F', to_date('19-Nov-85', 'DD-MON-RR'), 9801345678, 'sneha.raj@gmail.com', 100000, 'Service', 40000, 'Technical Manager', 'Nucleus');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C124', 'Bhavana', 'Sharma', 'F', to_date('25-Dec-84', 'DD-MON-RR'), 8674532789, 'bhavana.sharma@gmail.com', 100000, 'Service', 35000, 'Project Manager', 'TCS');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C125', 'Bharati', 'Raheja', 'F', to_date('10-Dec-69', 'DD-MON-RR'), 9783452123, 'bharati.raheja@gmail.com', 95000, 'Service', 38000, 'DBA', 'TerraData');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C126', 'Mamta', 'Kumari', 'F', to_date('11-Jan-76', 'DD-MON-RR'), 8567842314, 'mamta.kumari@gmail.com', 65000, 'Self-Employed', 40000, 'Freelance Developer', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C127', 'Bhavay', 'Gupta', 'M', to_date('20-Aug-78', 'DD-MON-RR'), 9344123456, 'bhavay.gupta@gmail.com', 65000, 'Self-Employed', 30000, 'Freelance Developer', NULL);

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C128', 'Dhawal', 'Kishore', 'M', to_date('14-Apr-77', 'DD-MON-RR'), 8653358913, 'dhawal.kishore@gmail.com', 80000, 'Service', 30000, 'Technical Lead', 'Nucleus');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C129', 'Divya', 'Singh', 'F', to_date('16-May-84', 'DD-MON-RR'), 9999123456, 'divya.singh@gmail.com', 70000, 'Service', 28000, 'HR Manager', 'HCL');

INSERT INTO LMS_CUSTOMER_M_SAGAR8998 (CUSTOMER_ID, FIRST_NAME, LAST_NAME, GENDER, DATE_OF_BIRTH, CONTACT_NUMBER, EMAIL_ADDRESS, MONTHLY_INCOME, PROFESSION, TOTAL_MONTHLY_EXPENSE, DESIGNATION, COMPANY_NAME) 
VALUES ('C130', 'Anaya', 'Grewal', 'F', to_date('7-Apr-84', 'DD-MON-RR'), 6789432123, 'anaya.grewal@gmail.com', 40000, 'Service', 30000, 'HR Executive', 'IBM');


------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

INSERT INTO LMS_PRODUCT_CATEGORY_M_SAGAR8998 (Category_ID, Category_Name, Asset_Based, Description, SecuredLoan) 
VALUES ('LN101', 'Home Loan', 'Y', NULL, 'S');

INSERT INTO LMS_PRODUCT_CATEGORY_M_SAGAR8998 (Category_ID, Category_Name, Asset_Based, Description, SecuredLoan) 
VALUES ('LN102', 'Consumer Vehicle Loan', 'Y', NULL, 'S');

INSERT INTO LMS_PRODUCT_CATEGORY_M_SAGAR8998 (Category_ID, Category_Name, Asset_Based, Description, SecuredLoan) 
VALUES ('LN103', 'Consumer Durable Loan', 'N', NULL, 'US');

INSERT INTO LMS_PRODUCT_CATEGORY_M_SAGAR8998 (Category_ID, Category_Name, Asset_Based, Description, SecuredLoan) 
VALUES ('LN104', 'Education Loan', 'N', NULL, 'US');

------------------------------------------------------------------------------------------------------------------------------------------------

INSERT INTO LMS_Product_M_SAGAR8998 (Product_Code, Product_Name, Product_Description, Product_Category, Max_Tenure, Min_Tenure) 
VALUES ('P101', 'Under-Construction', NULL, 'LN101', 20, 10);

INSERT INTO LMS_Product_M_SAGAR8998 (PRODUCT_CODE, PRODUCT_NAME, PRODUCT_DESCRIPTION, PRODUCT_CATEGORY, MAX_TENURE, MIN_TENURE) 
VALUES ('P102', 'Ready-to-move', NULL, 'LN101', 20, 5);

INSERT INTO LMS_Product_M_SAGAR8998 (PRODUCT_CODE, PRODUCT_NAME, PRODUCT_DESCRIPTION, PRODUCT_CATEGORY, MAX_TENURE, MIN_TENURE) 
VALUES ('P103', '4-wheeler', NULL, 'LN102', 7, 3);

INSERT INTO LMS_Product_M_SAGAR8998 (PRODUCT_CODE, PRODUCT_NAME, PRODUCT_DESCRIPTION, PRODUCT_CATEGORY, MAX_TENURE, MIN_TENURE) 
VALUES ('P104', '2-wheeler', NULL, 'LN102', 5, 2);

INSERT INTO LMS_Product_M_SAGAR8998 (PRODUCT_CODE, PRODUCT_NAME, PRODUCT_DESCRIPTION, PRODUCT_CATEGORY, MAX_TENURE, MIN_TENURE) 
VALUES ('P105', 'Electrical_Items', NULL, 'LN103', 2, 1);

INSERT INTO LMS_Product_M_SAGAR8998 (PRODUCT_CODE, PRODUCT_NAME, PRODUCT_DESCRIPTION, PRODUCT_CATEGORY, MAX_TENURE, MIN_TENURE) 
VALUES ('P106', 'Furniture', NULL, 'LN103', 2, 1);

INSERT INTO LMS_Product_M_SAGAR8998 (PRODUCT_CODE, PRODUCT_NAME, PRODUCT_DESCRIPTION, PRODUCT_CATEGORY, MAX_TENURE, MIN_TENURE) 
VALUES ('P107', 'Under-Graduate', NULL, 'LN104', 5, 3);

INSERT INTO LMS_Product_M_SAGAR8998 (PRODUCT_CODE, PRODUCT_NAME, PRODUCT_DESCRIPTION, PRODUCT_CATEGORY, MAX_TENURE, MIN_TENURE) 
VALUES ('P108', 'Post-Graduate', NULL, 'LN104', 5, 3);

---------------------------------------------------------------------------------------------------------------------------------------------------------
INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Home_101', 'C101', 15, 8.5, 3000000, 'M', to_date('10-Sep-18'), NULL, 'P101');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Home_102', 'C102', 17, 9, 4000000, 'M', to_date('12-Aug-17'), NULL, 'P101');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Home_103', 'C103', 10, 10.1, 3000000, 'M', to_date('18-Oct-19'), NULL, 'P102');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Home_104', 'C104', 12, 10.1, 5000000, 'M', to_date('15-Aug-16'), NULL, 'P102');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CVL_101', 'C105', 7, 12, 800000, 'Q', to_date('12-May-15'), NULL, 'P103');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CVL_102', 'C106', 5, 12, 600000, 'Q', to_date('25-Apr-18'), NULL, 'P103');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CVL_103', 'C107', 4, 9, 30000, 'HY', to_date('10-Apr-17'), NULL, 'P104');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CVL_104', 'C108', 4, 9, 40000, 'M', to_date('11-Sep-16'), NULL, 'P104');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CDL_101', 'C109', 1.5, 14, 10000, 'Y', to_date('11-Oct-19'), NULL, 'P105');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CDL_102', 'C110', 1.5, 14, 50000, 'M', to_date('10-Dec-19'), NULL, 'P105');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CDL_103', 'C111', 2, 12, 80000, 'M', to_date('14-Oct-19'), NULL, 'P106');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CDL_104', 'C112', 1, 12, 40000, 'M', to_date('12-Aug-20'), NULL, 'P106');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Edu_101', 'C113', 5, 15, 1000000, 'HY', to_date('10-May-18'), NULL, 'P107');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Edu_102', 'C114', 4, 15, 500000, 'Y', to_date('20-Dec-17'), NULL, 'P107');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Edu_103', 'C115', 4, 13, 800000, 'M', to_date('18-Nov-18'), NULL, 'P108');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Edu_104', 'C116', 5, 13, 500000, 'M', to_date('14-Oct-16'), NULL, 'P108');

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Home_105', 'C117', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Home_106', 'C118', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Home_107', 'C119', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Home_108', 'C120', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CVL_105', 'C121', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CVL_106', 'C122', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CVL_107', 'C123', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CVL_108', 'C124', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CDL_105', 'C125', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CDL_106', 'C126', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CDL_107', 'C127', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_CDL_108', 'C128', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Edu_105', 'C129', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Edu_106', 'C130', NULL, NULL, NULL, NULL, NULL, NULL, NULL);

INSERT INTO LMS_AGREEMENT_DTL_SAGAR8998 (AGREEMENT_ID, LESSEE_ID, TENURE, ROI, LOAN_AMOUNT, REPAYMENT_FREQUENCY, LOAN_DISBURSAL_DATE, STATUS, PRODUCT_CODE) 
VALUES ('LN_Edu_107', 'C130', NULL, NULL, NULL, NULL, NULL, NULL, NULL);






















--QUESTION 9--
SELECT * FROM LMS_CUSTOMER_M_SAGAR8998;

--QUESTION 8--
COMMIT;

--QUESTION 10--
UPDATE LMS_CUSTOMER_M_SAGAR8998
SET Last_Name = 'Sharma'
    where Customer_ID = 'C103';
    
--QUESTION 11--
UPDATE LMS_CUSTOMER_M_SAGAR8998
SET Profession = 'Service',
    Designation = 'Asst Manager',
    Company_Name = 'Wipro' 
WHERE 
    Customer_ID = 'C104';
    
--QUESTION 12--
DELETE FROM LMS_CUSTOMER_M_SAGAR8998
WHERE
    Total_Monthly_Expense < 40000;
    
--QUESTION 13--
Delete from LMS_AGREEMENT_DTL_SAGAR8998
WHERE
Loan_Disbursal_Date < (2000 , YYYY);

--Question 17--
TRUNCATE table FROM table LMS_AGREEMENT_DTL_SAGAR8998;

------------------------ASSIGNMENT 3----------------------------------

--QUESTION 1--

SELECT last_name, gender, monthly_income AS income FROM LMS_Customer_M; 


--QUESTION 2--
SELECT * FROM LMS_Product_M; 

--QUESTION 3-- 
SELECT customer_id, last_name, monthly_income * 12 "ANNUAL INCOME" FROM LMS_Customer_M; 

--QUESTION 4--
select customer_id, designation from LMS_Customer_M where designation = null;

------------------------------------------------------------------------------------------------------------------

--QUESTION 1--
SELECT agreement_id, loan_amount, tenure, roi, loan_disbursal_date from LMS_AGREEMENT_DTL_SAGAR899; 

--QUESTION 2--
SELECT agreement_id, loan_amount, tenure, roi, loan_disbursal_date as "DISBURSAL DATE" FROM LMS_AGREEMENT_DTL_SAGAR899;

--QUESTION 3--
SELECT DISTINCT Designation FROM LMS_CUSTOMER_M_SAGAR899;

--QUESTION 4--
SELECT * FROM LMS_AGREEMENT_DTL_SAGAR899
WHERE Loan_Disbursal_Date IS NULL;

--QUESTION 5--
SELECT * FROM LMS_AGREEMENT_DTL_SAGAR899
WHERE Loan_Disbursal_Date BETWEEN '01-03-20' AND '31-03-20';

--QUESTION 6--
SELECT * FROM LMS_AGREEMENT_DTL_SAGAR899
WHERE Loan_Amount > 500000 AND ROI < 10;

--QUESTION 7--
SELECT * FROM LMS_PAYMENT_DTL_SAGAR899
WHERE Status = 'C';

--QUESTION 8--
SELECT * FROM LMS_CHEQUE_DTL_SAGAR899
WHERE Payment_Mode IN ('C', 'D');

--QUESTION 9--
SELECT * FROM LMS_TXNTYPE_M_SAGAR899
WHERE Txn_Type = 'Installment';

--QUESTION 10--
SELECT * FROM lMS_PRODUCT_CATEGORY_M_SAGAR899
WHERE SecuredLoan = 'S';

--UESTION 11--
SELECT Last_Name || ',' || Designation AS "Customer and Title"
FROM LMS_CUSTOMER_M_SAGAR899;

--QUESTION 12--
SELECT * FROM LMS_CHEQUE_DTL_SAGAR899
ORDER BY Deposit_Date DESC;

--QUESTION 13--
SELECT Current_Date "DATE" FROM DUAL;

--QUESTION 14--
SELECT * FROM LMS_CHEQUE_DTL_SAGAR899
WHERE Cheque_Date = Deposit_date;

--QUESTION 15--
SELECT Agreement_id,PropInstID, ROUND((CURRENT_DATE - Installment_Due_Date)*100,2) AS "PENALTY CHARGES"
FROM LMS_REPAYSCH_DTL_SAGAR899
WHERE Installment_Due_Date < CURRENT DATE;

--QUESTION 16--
SELECT Customer_ID, First_Name, Last_Name,
ROUND(Total_Monthly_Expense/Monthly_Income,2) AS "DBR"
FROM LMS_CUSTOMER_M_SAGAR899;

--QUESTION 17--
SELECT First_Name AS "Name", INITCAP(Last_Name) AS "Last Name",
LENGTH(Last_Name) AS "Length Of Last Name"
FROM LMS_CUSTOMER_M_SAGAR899
WHERE UPPER(SUBSTR(First_Name, 1,2)) IN ('J', 'A', 'M');

--QUESTION 18--
SELECT First_Name, Last_Name, SUBSTR(First_Name, 1, 1) || SUBSTR(Last_Name, -3, 3) || '@nucleussoftware.com' as "email address"
FROM LMS_CUSTOMER_M_SAGAR899;

--QUESTION 19--
SELECT Installment_Amount, Installment_Due_Date AS "First_Installmet"
FROM LMS_REPAYSCH_DTL_SAGAR899
WHERE Installment_Number = 1;

--QUESTION 1--
SELECT C.First_Name, P.Product_Name, P.Product_Category, A.Loan_Amount,A.Loan_Disbursal_Date, A.Repayment_Frequency 
FROM LMS_CUSTOMER_M_SAGAR8998 C 
JOIN LMS_AGREEMENT_DTL_SAGAR8998 A ON C.Customer_ID = A.Lessee_ID 
JOIN LMS_Product_M_SAGAR8998 P ON A.Product_Code = P.Product_Code;

--QUESTION 2--
SELECT A.Agreement_ID, C.First_Name, T.Txn_Advice_ID, T.AdviceDate, P.Payment_ID, T.Adviceamt, P.Payment_Date
FROM LMS_AGREEMENT_DTL_SAGAR8998 A
JOIN LMS_CUSTOMER_M_SAGAR8998 C ON A. lessee_id=C.Customer_Id
JOIN LMS_TXN_ADVICE_DTL_SAGAR8998 T ON T.CASE_ID=A.Agreement_ID 
JOIN LMS_PAYMENT_DTL_SAGAR8998 P ON P.Txn_Advice_ID=T. Txn_Advice_ID
WHERE Agreement_ID='&AGR_ID';


SELECT * FROM LMS_AGREEMENT_DTL_SAGAR8998;


--QUESTION 3 --
SELECT * FROM LMS_TXN_ADVICE_DTL_SAGAR8998 T 
JOIN LMS_PAYMENT_DTL_SAGAR8998 P ON P.TXN_ADVICE_ID = T.Txn_Advice_id 
JOIN LMS_CHEQUE_DTL_SAGAR8998 C ON P.CHEQUE_ID = C.CHEQUE_ID
WHERE CHEQUE_NUM = '&CHEQUE_NUM';

SELECT * FROM LMS_CHEQUE_DTL_SAGAR8998;

--QUESTION 4--
SELECT COUNT(*) FROM LMS_AGREEMENT_DTL_SAGAR8998 A 
JOIN LMS_TXN_ADVICE_DTL_SAGAR8998 T ON A.agreement_id = T.case_id 
JOIN LMS_PAYMENT_DTL_SAGAR8998 P ON t.Txn_Advice_id = p.txn_advice_id
WHERE A.Agreement_ID = '&AGR_';

SELECT * FROM LMS_AGREEMENT_DTL_SAGAR8998;


--QUESTION 5--
SELECT COUNT(*), SUM(C.Cheque_Amount) 
FROM LMS_AGREEMENT_DTL_SAGAR8998 A 
JOIN LMS_TXN_ADVICE_DTL_SAGAR8998 T ON a.agreement_id = t.case_id 
JOIN LMS_PAYMENT_DTL_SAGAR8998 P on t.txn_advice_id = p.txn_advice_id
JOIN LMS_CHEQUE_DTL_SAGAR8998 C ON p.cheque_id = c.cheque_id 
WHERE A.Agreement_ID = 'GR_ID' AND c.Payment_Mode = 'C' OR c.Payment_Mode = '0';

--QUESTION 6--
SELECT COUNT(*), SUM(C.Cheque_Amount)
FROM LMS_AGREEMENT_DTL_SAGAR8998 A
JOIN LMS_TXN_ADVICE_DTL_SAGAR8998 T ON a.agreement_id = t.case_id
JOIN LMS_PAYMENT_DTL_SAGAR8998 P ON t.txn_advice_id = p.txn_advice_id 
JOIN LMS_CHEQUE_DTL_SAGAR8998 C ON p.cheque_id = c.cheque_id
WHERE A.Agreement_ID = '&AGR_ID' AND c.status='B';

SELECT * FROM LMS_AGREEMENT_DTL_SAGAR8998;

--QUESTION 7--
SELECT COUNT(*), SUM(C.Cheque_Amount) FROM LMS_AGREEMENT_DTL_SAGAR8998 A 
JOIN LMS_TXN_ADVICE_DTL_SAGAR8998 T ON a.agreement_id = t.case_id 
JOIN LMS_PAYMENT_DTL_SAGAR8998 P ON t.txn_advice_id = p.txn_advice_id 
JOIN LMS_CHEQUE_DTL_SAGAR8998 C ON p.cheque_id = c.cheque_id
WHERE c.Payment_Mode = 'C' OR c.Payment_Mode = 'Q';

--QUESTION 8--
SELECT c.customer_id, c.first_name, c.last_name, ag.lessee_id, ag.agreement_id, ag.product_code, r.propinstId 
FROM LMS_CUSTOMER_M_SAGAR8998 c
JOIN LMS_AGREEMENT_DTL_SAGAR8998 ag on c.customer_id = ag.lessee_id LEFT OUTER JOIN LMS_REPAYSCH_DTL_SAGAR8998 R on ag.agreement_id = r.agreement_id 
where r.propinstid IS NULL and customer_id = 'customer_id';


--QUESTION 9--
SELECT C.First_Name, P.Product_Name, A.Loan_Amount 
FROM LMS_CUSTOMER_M_SAGAR8998 C 
JOIN LMS_AGREEMENT_DTL_SAGAR8998 A ON A.Lessee_ID = C.Customer_Id 
JOIN LMS_Product_M_SAGAR8998 P ON P.Product_Code = a.product_code 
JOIN LMS_PRODUCT_CATEGORY_M_SAGAR8998 PC ON P.Product_Category = PC.Category_ID 
WHERE PC.Asset_Based = 'Y';

--QUESTION 10--
Select SUM(installment_amount) from LMS_REPAYSCH_DTL_SAGAR8998 r
WHERE r.installment_due_date <= '&date';

select * from LMS_REPAYSCH_DTL_SAGAR8998;

--QUESTION 11--
SELECT c.customer_id, c.first_name, c.last_name, a.lessee_id
FROM LMS_CUSTOMER_M_SAGAR8998 c
JOIN LMS_AGREEMENT_DTL_SAGAR8998 a ON c.Customer_Id = a.lessee_id
JOIN LMS_REPAYSCH_DTL_SAGAR8998 R ON R.Agreement_ID = A.Agreement_ID 
JOIN LMS_TXN_ADVICE_DTL_SAGAR8998 T ON A.Agreement_ID = T.Case_Id
JOIN LMS_PAYMENT_DTL_SAGAR8998 P ON T.Txn_Advice_id = P.Txn_Advice_id
WHERE P.Payment_Date <= R.Installment_Due_Date;

--QUESTION 12--
SELECT * FROM LMS_AGREEMENT_DTL_SAGAR8998;

SELECT p.Product_Name,p.Max_Tenure,p.Min_Tenure, pc.Asset_Based, pc.securedloan
FROM LMS_Product_M_SAGAR8998 p 
JOIN LMS_AGREEMENT_DTL_SAGAR8998 a ON p.product_code = a.product_code 
JOIN LMS_PRODUCT_CATEGORY_M_SAGAR8998 pc ON p.Product_Category = pc.Category_ID 
WHERE a.agreement_id = 'sagreement_id';

--QUESTION 13--
SELECT * FROM LMS_REPAYSCH_DTL_SAGAR8998;

SELECT * FROM LMS_AGREEMENT_DTL_SAGAR8998 ag 
JOIN LMS_REPAYSCH_DTL_SAGAR8998 r ON ag.Agreement_ID = r.Agreement_id
WHERE r.PropInstID = '&PropInstID';


--QUESTION 14--
SELECT * FROM LMS_AGREEMENT_DTL_SAGAR8998 ;

SELECT Loan_Amount, Installment_Amount, Principal_Component, Interest_Component 
FROM LMS_AGREEMENT_DTL_SAGAR8998 ag
JOIN LMS_REPAYSCH_DTL_SAGAR8998 r ON ag.Agreement_ID = r.Agreement_id
WHERE ag.Agreement_ID = '&Agreement_ID';


--QUESTION 15--
SELECT * FROM LMS_CUSTOMER_M_SAGAR8998 c 
JOIN LMS_AGREEMENT_DTL_SAGAR8998 a ON c.customer_id = a.lessee_id 
WHERE a.agreement_id like '%Home%';
